<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Oregon Wildfires</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Personal Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="a.html">About Me</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Projects
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Class Projects</li>
    <li>
      <a href="a.html">P1</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Personal Projects</li>
    <li>
      <a href="a.html">P2</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Oregon Wildfires</h1>

</div>


<p><strong>Note:</strong> This work was presented as a solution for an
open ended homework question for the advanced predictive models course.
The objective of the assignment was to identify and visualize a spatial
point pattern. The key skill demonstrated here is being able to procure
data from a random source, prepare and analyse it in a given
context.</p>
<p>A <strong>spatial point pattern</strong> is a set of events (wildfire
locations in this case), irregularly distributed with in a designated
region, that can be viewed as being generated by a random mechanism
(week 4-lecture slides). Wildfires are considered stochastic, because
they’re thought to be a randomly occurring natural phenomenon.</p>
<p>Summer of 2020 was a particularly bad season for wildfires along the
west coast, driving the air quality in some cities along the coast to
worst in the world for a few days. <a
href="https://www.cnn.com/us/live-news/west-coast-wildfires-09-10-2020/index.html">Read
here</a></p>
<p>I obtained the <a
href="https://firms.modaps.eosdis.nasa.gov/country/">wildfire data</a>
from NASA website for year 2020, collected using the MODIS instrument.
The data file was filtered to retain information for the state of
interest (i.e. Oregon) only.</p>
<pre class="r"><code>df &lt;- read.csv(&#39;Data/modis_2020_United_States.csv&#39;, header = TRUE)

#retain the subset of the data for the state of Oregon only. Used the bbox limits for the state from the shape file 
#for filtering
#need to figure out a better way to do this, because geographic boundary is not a perfect rectangle.
sub_df &lt;- df[which(df$longitude &gt;= -124.70 &amp; df$longitude &lt;= -116.46),]
sub_df &lt;- sub_df[which(sub_df$latitude&gt;=41.99 &amp; sub_df$latitude&lt;=46.299),]</code></pre>
<p>The <a
href="https://www.sciencebase.gov/catalog/item/59fa9f62e4b0531197affb5d">shape
file</a> containing boundaries of the state was obtained from USGS
(United States Geological Survey) website.</p>
<pre class="r"><code>library(rgdal)
x&lt;-readOGR(&quot;Data/Shape/GU_StateOrTerritory.shp&quot;)
#plot(x)
boundaryPoints=x@polygons[[1]]@Polygons[[1]]@coords
#boundaryPoints
owinBound=owin(poly=data.frame(x=rev(boundaryPoints[,1]), y=rev(boundaryPoints[,2])))
#owinBound

pppData &lt;- ppp(x = sub_df$longitude, y = sub_df$latitude,window=owinBound)
#plot(pppData)
#attr(pppData,&quot;rejects&quot;)
oregon_wildfires &lt;- as.ppp(pppData)

plot(oregon_wildfires)</code></pre>
<p><img src="oregon_wildfires_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div id="analysis" class="section level2">
<h2>Analysis:</h2>
<p>This data represents a non-homogeneous poisson process, which is
characterized by</p>
<ul>
<li><strong>Spatial variation in intensity</strong> - the number of
events (locations) NOT following a random poisson distribution in the
specified region of interest. A spatial variation in the intensity of
points is seen on visual inspection. There are some areas with no
evidence of fire (which may correspond to cities, urbanized areas).</li>
<li><strong>Clustering</strong> Some areas show random distribution of
fires with a lot of clustering. For this analysis, information about
mark (urban vs.forest land) and covariates (humidity, direction of wind,
temperature, density of the trees) has not been included.</li>
</ul>
</div>
<div id="quadrant-plot" class="section level2">
<h2>Quadrant plot</h2>
<p>This plot divides the state into a set number of quadrants, and
reports the counts per quadrant.Then a chi squared test is run to see if
the actual number of fires in a given quadrant matches the expected
(predicted) number of fires, under the <span class="math inline">\(H_0
=\)</span> wildfires arise from a homogeneous poisson process.</p>
<pre class="r"><code># Qudarant plot
Q &lt;- quadratcount(oregon_wildfires, 
                  nx = 8, 
                  ny = 5) 

plot(oregon_wildfires, 
     cex = 0.5, 
     pch = &quot;+&quot;)
plot(Q, 
     add = TRUE, 
     cex = 1)</code></pre>
<p><img src="oregon_wildfires_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="chi-squared-test" class="section level2">
<h2>Chi-squared test:</h2>
<p>The results from the chi-squared test are shown below. The p-value is
very small which indicates that we can reject the null hypothesis $H_0 =
$ The data arose from a homogeneous poisson process.</p>
<pre class="r"><code># chi-squared test
# TESTING FOR CSR (chi-squared test)

oregon_wildfires.quadtest &lt;- quadrat.test(oregon_wildfires, 
                             nx = 8, 
                             ny = 5)  # how does number of quadrants affect results?
oregon_wildfires.quadtest</code></pre>
<pre><code>## 
##  Chi-squared test of CSR using quadrat counts
## 
## data:  oregon_wildfires
## X2 = 57658, df = 39, p-value &lt; 2.2e-16
## alternative hypothesis: two.sided
## 
## Quadrats: 40 tiles (irregular windows)</code></pre>
</div>
<div id="quad-test-plot-showing-actual-and-expected-counts-per-qudrant"
class="section level2">
<h2>Quad test plot (showing actual and expected counts per qudrant)</h2>
<pre class="r"><code>plot.quadrattest(oregon_wildfires.quadtest,cex = 0.5)</code></pre>
<p><img src="oregon_wildfires_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p><strong>The text in each quadrant represents the actual count(left),
expected count(right) and the pearson residuals (bottom)</strong></p>
</div>
<div id="discussion" class="section level2">
<h2>Discussion:</h2>
<p>This analysis was done on a large area, and the model was not
controlled for the covariates. A better and more useful analysis would
divide the state into smaller regions (by county, possibly). Control for
developed (urban) areas vs. forest land. And more importantly, control
for covariates (i.e. fire conditions).</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
